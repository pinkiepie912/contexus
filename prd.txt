# Contexus í”„ë¡¬í”„íŠ¸ ìŠ¤íŠœë””ì˜¤ êµ¬í˜„ ê³„íšì„œ (PRD)

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### ê¸°íš ëª©í‘œ
- **ì„œë¹„ìŠ¤ ëª…**: í”„ë¡¬í”„íŠ¸ ìŠ¤íŠœë””ì˜¤ (Prompt Studio)
- **ëª©ì **: ì‚¬ìš©ìê°€ LLM ëŒ€í™”ë¥¼ ì¤‘ë‹¨ ì—†ì´ ë³´ë©´ì„œ, Side Panelì—ì„œ ì €ì¥ëœ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ë ˆê³  ë¸”ë¡ì²˜ëŸ¼ ì¡°ë¦½í•˜ì—¬ ì •êµí•œ í”„ë¡¬í”„íŠ¸ë¥¼ ì™„ì„±
- **í•µì‹¬ ì»¨ì…‰**: Library(ë¼ì´ë¸ŒëŸ¬ë¦¬)ì™€ Builder(ë¹Œë”) ë‘ ì˜ì—­ìœ¼ë¡œ ë¶„ë¦¬ëœ ì§ê´€ì  UX

### ê¸°ìˆ  ìŠ¤íƒ ë¶„ì„
- **í˜„ì¬ êµ¬ì¡°**: React 19 + TypeScript + Tailwind CSS 4.1 + Zustand + Dexie (IndexedDB)
- **UI ì»´í¬ë„ŒíŠ¸**: shadcn/ui (Radix UI + CVA) - 6ê°œ ì»´í¬ë„ŒíŠ¸ ê¸°ì¡´ êµ¬ì¶•
- **ì•„í‚¤í…ì²˜**: Chrome Extension MV3 + Content Script + Side Panel
- **ë°ì´í„° ëª¨ë¸ ë³€ê²½**: Element ì¤‘ì‹¬ìœ¼ë¡œ ë‹¨ìˆœí™” (Snippet, Role í…Œì´ë¸” ì œê±°)
- **ê¸°ì¡´ shadcn/ui**: Button, Card, Input, ScrollArea, Select, Toast

### ì•„í‚¤í…ì²˜ ë‹¨ìˆœí™” ë°©í–¥
- **ê¸°ì¡´**: Snippet (ìº¡ì²˜) + Role (ì—­í• ) â†’ ë³µì¡í•œ ì¡°í•©
- **ì‹ ê·œ**: Elementë§Œ ì‚¬ìš© (template, context, example, role íƒ€ì…ìœ¼ë¡œ í†µí•©)
- **ì¥ì **: ë‹¨ìˆœí•œ ë°ì´í„° ëª¨ë¸, í†µí•©ëœ ê²€ìƒ‰/ê´€ë¦¬, ì¼ê´€ëœ UX

## 2. ë°ì´í„° ëª¨ë¸ ì„¤ê³„

### 2.1 Element ì¤‘ì‹¬ í†µí•© ëª¨ë¸
```typescript
// ë‹¨ì¼ Element ëª¨ë¸ - ëª¨ë“  í”„ë¡¬í”„íŠ¸ êµ¬ì„± ìš”ì†Œ í†µí•©
interface Element {
  id: string;
  type: 'template' | 'context' | 'example' | 'role';  // 4ê°€ì§€ íƒ€ì…
  trigger: string;  // í•„ìˆ˜: /blog, /company_info, /writing_style, /expert

  // ê³µí†µ í•„ë“œ
  title: string;  // í•„ìˆ˜ë¡œ ë³€ê²½
  content: string;
  description?: string;
  tags?: string[];
  createdAt: Date;
  updatedAt?: Date;
  isFavorite?: boolean;
  usageCount: number;  // ì‚¬ìš© ë¹ˆë„ ì¶”ì 

  // Template ì „ìš© í•„ë“œ
  requiredSlots?: SlotDefinition[];

  // Role ì „ìš© í•„ë“œ (ê¸°ì¡´ Role í…Œì´ë¸” í†µí•©)
  category?: string;  // 'coding', 'writing', 'analysis' ë“±
  promptTemplate?: string;  // role íƒ€ì…ì¼ ë•Œ ì‚¬ìš©
}

interface SlotDefinition {
  id: string;
  name: string;  // 'Context', 'Examples', 'Role'
  type: 'context' | 'example' | 'role' | 'text';
  required: boolean;
  placeholder?: string;
}

// Builder ìƒíƒœ ê´€ë¦¬
interface BuilderState {
  elements: BuilderElement[];
  selectedTemplate?: Element;
}

interface BuilderElement {
  id: string;
  element: Element;
  slotAssignments?: Record<string, Element>;  // slotId â†’ Element
}
```

### 2.2 ë‹¨ìˆœí™”ëœ IndexedDB ìŠ¤í‚¤ë§ˆ (Elementë§Œ ì‚¬ìš©)
```typescript
// src/lib/db.ts - ì™„ì „íˆ ìƒˆë¡œìš´ ë‹¨ìˆœ êµ¬ì¡°
export class ContextusDB extends Dexie {
  elements!: EntityTable<Element, "id">;  // ë‹¨ì¼ í…Œì´ë¸”

  constructor() {
    super("ContextusDB");

    // ë²„ì „ 1: Element ì¤‘ì‹¬ ë‹¨ìˆœ ìŠ¤í‚¤ë§ˆ
    this.version(1).stores({
      elements: "id, type, trigger, title, content, createdAt, usageCount, *tags, isFavorite, category"
    });

    // ê¸°ë³¸ ë°ì´í„° ì‹œë”©
    this.on("populate", () => this.seedDefaultElements());
  }

  private async seedDefaultElements(): Promise<void> {
    const defaultElements: Element[] = [
      // Template íƒ€ì…
      {
        id: uuidv4(),
        type: 'template',
        trigger: '/blog',
        title: 'ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ì‘ì„±',
        content: 'ì£¼ì œ: {topic}\n\në‹¤ìŒ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”...',
        description: 'ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ì‘ì„±ìš© í…œí”Œë¦¿',
        requiredSlots: [
          { id: 'context', name: 'Context', type: 'context', required: true, placeholder: 'íšŒì‚¬/ì œí’ˆ ì •ë³´' },
          { id: 'examples', name: 'Examples', type: 'example', required: false, placeholder: 'ì‘ì„± ì˜ˆì‹œ' },
          { id: 'role', name: 'Role', type: 'role', required: false, placeholder: 'ì‘ì„±ì ì—­í• ' }
        ],
        createdAt: new Date(),
        usageCount: 0
      },

      // Context íƒ€ì…
      {
        id: uuidv4(),
        type: 'context',
        trigger: '/company',
        title: 'íšŒì‚¬ ì†Œê°œ',
        content: 'ìš°ë¦¬ íšŒì‚¬ëŠ” AI ê¸°ë°˜ ì†”ë£¨ì…˜ì„ ì œê³µí•˜ëŠ”...',
        description: 'íšŒì‚¬ ê¸°ë³¸ ì •ë³´',
        createdAt: new Date(),
        usageCount: 0
      },

      // Example íƒ€ì…
      {
        id: uuidv4(),
        type: 'example',
        trigger: '/good_writing',
        title: 'ì¢‹ì€ ê¸€ì“°ê¸° ì˜ˆì‹œ',
        content: 'ì˜ˆì‹œ: ëª…í™•í•˜ê³  ê°„ê²°í•œ ë¬¸ì²´ë¡œ...',
        description: 'ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼ ì˜ˆì‹œ',
        createdAt: new Date(),
        usageCount: 0
      },

      // Role íƒ€ì… (ê¸°ì¡´ Role í…Œì´ë¸”ì„ Elementë¡œ í†µí•©)
      {
        id: uuidv4(),
        type: 'role',
        trigger: '/expert',
        title: 'ì „ë¬¸ê°€',
        content: 'ë‹¹ì‹ ì€ í•´ë‹¹ ë¶„ì•¼ì˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤...',
        promptTemplate: 'ë‹¹ì‹ ì€ {field} ë¶„ì•¼ì˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì •í™•í•˜ê³  ì „ë¬¸ì ì¸ ë‹µë³€ì„ ì œê³µí•´ì£¼ì„¸ìš”.',
        category: 'general',
        createdAt: new Date(),
        usageCount: 0
      }
    ];

    await this.elements.bulkAdd(defaultElements);
  }
}
```

### 2.3 IndexedDB ìµœì í™” ì „ëµ
- **ì¸ë±ì‹±**: type, trigger, tags ë©€í‹°ê°’ ì¸ë±ìŠ¤ë¡œ ë¹ ë¥¸ ê²€ìƒ‰
- **ë³µí•© ì¸ë±ìŠ¤**: [type, createdAt], [platform, type] ì¡°í•© ì¸ë±ìŠ¤
- **ìºì‹±**: ìì£¼ ì‚¬ìš©í•˜ëŠ” í…œí”Œë¦¿ì€ ë©”ëª¨ë¦¬ ìºì‹œ
- **ë°°ì¹˜ ì²˜ë¦¬**: bulkAdd/bulkUpdateë¡œ ì„±ëŠ¥ ìµœì í™”
- **ì§€ì—° ë¡œë”©**: ëŒ€ìš©ëŸ‰ ì»¨í…ì¸ ëŠ” í•„ìš”ì‹œì—ë§Œ ë¡œë“œ

## 3. ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜

### 3.1 shadcn/ui ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
```
PromptStudio (src/sidepanel/PromptStudio.tsx)
â”œâ”€â”€ Library (ìƒë‹¨) - Card ì»¨í…Œì´ë„ˆ
â”‚   â”œâ”€â”€ SearchInput - shadcn/ui Input + Search ì•„ì´ì½˜
â”‚   â”œâ”€â”€ FilterTabs - shadcn/ui Button (variant="ghost") ì¡°í•©
â”‚   â””â”€â”€ ElementList - shadcn/ui ScrollArea
â”‚       â””â”€â”€ ElementCard - shadcn/ui Card + Badge + Button
â””â”€â”€ Builder (í•˜ë‹¨) - Card ì»¨í…Œì´ë„ˆ
    â”œâ”€â”€ EmptyState - ì»¤ìŠ¤í…€ ì»´í¬ë„ŒíŠ¸
    â”œâ”€â”€ TemplateSlot - shadcn/ui Card + Badge
    â”œâ”€â”€ SlotComponents[] - shadcn/ui Card + Input + Button
    â””â”€â”€ ActionButtons - shadcn/ui Button ì¡°í•©
```

### 3.2 ì¶”ê°€ í•„ìš”í•œ shadcn/ui ì»´í¬ë„ŒíŠ¸
í”„ë¡œì íŠ¸ì— ë‹¤ìŒ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤:
- **Badge**: 4ê°€ì§€ íƒ€ì… ë±ƒì§€ (template/context/example/role), íŠ¸ë¦¬ê±° íƒœê·¸ìš©
- **Tabs**: í•„í„° íƒ­ [ì „ì²´]/[í…œí”Œë¦¿]/[ì»¨í…ìŠ¤íŠ¸]/[ì˜ˆì‹œ]/[ì—­í• ]
- **Separator**: Libraryì™€ Builder ì˜ì—­ êµ¬ë¶„ìš©
- **Label**: ìŠ¬ë¡¯ ë¼ë²¨ìš©
- **DropdownMenu**: ì—˜ë¦¬ë¨¼íŠ¸ ì¶”ê°€/í¸ì§‘ ì˜µì…˜
- **Popover**: ì¸ë¼ì¸ ê²€ìƒ‰ íŒì—…
- **Command**: íŠ¸ë¦¬ê±° ê¸°ë°˜ ê²€ìƒ‰ ìë™ì™„ì„±
- **Dialog**: ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±/í¸ì§‘ ëª¨ë‹¬

### 3.3 shadcn/ui ê¸°ë°˜ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

#### ElementCard (shadcn/ui Card + Badge + Button)
```typescript
import { Card, CardContent, CardHeader } from "~/components/ui/card"
import { Badge } from "~/components/ui/badge"
import { Button } from "~/components/ui/button"

interface ElementCardProps {
  element: Element;
  onQuickAdd: (element: Element) => void;
  draggable?: boolean;
}

// ì‚¬ìš© ì˜ˆì‹œ
<Card className="group cursor-move hover:shadow-md transition-shadow" draggable>
  <CardHeader className="pb-2">
    <div className="flex items-center justify-between">
      <Badge variant={getVariantByType(element.type)}>
        {element.type.toUpperCase()}
      </Badge>
      <Button
        size="icon"
        variant="ghost"
        className="opacity-0 group-hover:opacity-100"
        onClick={() => onQuickAdd(element)}
      >
        <Plus className="h-4 w-4" />
      </Button>
    </div>
  </CardHeader>
  <CardContent>
    <Badge variant="outline" className="mb-2">
      {element.trigger}
    </Badge>
    <p className="text-sm text-muted-foreground line-clamp-3">
      {element.content}
    </p>
  </CardContent>
</Card>
```

#### Builder (shadcn/ui Card ê¸°ë°˜)
```typescript
import { Card, CardContent, CardHeader, CardTitle } from "~/components/ui/card"
import { Button } from "~/components/ui/button"
import { Separator } from "~/components/ui/separator"

interface BuilderProps {
  elements: BuilderElement[];
  onAddElement: (element: Element, slotId?: string) => void;
  onRemoveElement: (elementId: string) => void;
  onInject: () => void;
  onCopy: () => void;
}
```

#### SlotComponent (shadcn/ui Input + Card)
```typescript
import { Input } from "~/components/ui/input"
import { Label } from "~/components/ui/label"
import { Button } from "~/components/ui/button"
import { X } from "lucide-react"

interface SlotProps {
  slot: SlotDefinition;
  assignedElement?: Element;
  onDrop: (element: Element) => void;
  onRemove: () => void;
  onInlineSearch: () => void;
}

// ì‚¬ìš© ì˜ˆì‹œ
<div className="space-y-2">
  <Label>{slot.name}</Label>
  {assignedElement ? (
    <Card className="p-2">
      <div className="flex items-center justify-between">
        <Badge variant="outline">{assignedElement.trigger}</Badge>
        <Button size="icon" variant="ghost" onClick={onRemove}>
          <X className="h-4 w-4" />
        </Button>
      </div>
    </Card>
  ) : (
    <Input
      placeholder={slot.placeholder}
      onFocus={onInlineSearch}
      className="border-dashed"
    />
  )}
</div>
```

## 4. êµ¬í˜„ ë‹¨ê³„ë³„ ê³„íš

### Phase 1: ë°ì´í„° ëª¨ë¸ ë° ê¸°ë°˜ êµ¬ì¡° (3-4ì¼)

#### Step 1.1: shadcn/ui ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
- **ì‘ì—…**: í•„ìš”í•œ shadcn/ui ì»´í¬ë„ŒíŠ¸ ì„¤ì¹˜
- **ëª…ë ¹ì–´**:
  ```bash
  # ì¶”ê°€ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ë“¤
  npx shadcn@latest add badge
  npx shadcn@latest add tabs
  npx shadcn@latest add separator
  npx shadcn@latest add label
  npx shadcn@latest add dropdown-menu
  npx shadcn@latest add popover
  npx shadcn@latest add command
  npx shadcn@latest add dialog
  ```

#### Step 1.2: íƒ€ì… ì •ì˜ í™•ì¥
- **íŒŒì¼**: `src/types.ts`
- **ì‘ì—…**: Element, SlotDefinition, BuilderState ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€
- **ë³€ê²½ì‚¬í•­**: ê¸°ì¡´ Snippet íƒ€ì…ì„ Elementë¡œ í™•ì¥

#### Step 1.3: IndexedDB ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸
- **íŒŒì¼**: `src/lib/db.ts`
- **ì‘ì—…**:
  - ContextusDB ë²„ì „ 2 ìŠ¤í‚¤ë§ˆ ì¶”ê°€
  - elements, builderTemplates í…Œì´ë¸” ì¶”ê°€
  - ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡œì§ (snippets â†’ elements)
  - ë³µí•© ì¸ë±ìŠ¤ ìµœì í™”
- **IndexedDB ìµœì í™”**:
  - ë³µí•© ì¸ë±ìŠ¤: [type, createdAt], [platform, type]
  - ë©€í‹°ê°’ ì¸ë±ìŠ¤: *tags
  - ë°°ì¹˜ ì²˜ë¦¬ìš© bulkAdd/bulkUpdate ìœ í‹¸

#### Step 1.4: ìƒíƒœ ê´€ë¦¬ ì„¤ì • (Zustand)
- **íŒŒì¼**: `src/stores/builderStore.ts` (ì‹ ê·œ)
- **ì‘ì—…**: Builder ìƒíƒœ ê´€ë¦¬
- **ê¸°ëŠ¥**:
  - ì—˜ë¦¬ë¨¼íŠ¸ ì¶”ê°€/ì œê±°
  - ìŠ¬ë¡¯ í• ë‹¹/í•´ì œ
  - ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìƒíƒœ
  - ìµœì¢… í”„ë¡¬í”„íŠ¸ ìƒì„±

#### Step 1.5: IndexedDB API í•¨ìˆ˜ í™•ì¥
- **íŒŒì¼**: `src/lib/db.ts`, `src/lib/messaging.ts`
- **ì‘ì—…**: Element CRUD ë° ê²€ìƒ‰ ìµœì í™”
- **ê¸°ëŠ¥**:
  - createElement, updateElement, deleteElement
  - searchElements (ì¸ë±ìŠ¤ í™œìš© ìµœì í™”)
  - getElementsByType, getTemplatesWithSlots
  - ìºì‹œ ì „ëµ: ìì£¼ ì‚¬ìš©í•˜ëŠ” í…œí”Œë¦¿ ë©”ëª¨ë¦¬ ìºì‹œ

### Phase 2: Library ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ (shadcn/ui ê¸°ë°˜, 4-5ì¼)

#### Step 2.1: ElementCard ì»´í¬ë„ŒíŠ¸ (shadcn/ui Card + Badge)
- **íŒŒì¼**: `src/sidepanel/components/ElementCard.tsx` (ì‹ ê·œ)
- **shadcn/ui ì»´í¬ë„ŒíŠ¸**: Card, CardHeader, CardContent, Badge, Button
- **ì‘ì—…**:
  - HTML5 Drag APIë¡œ ë“œë˜ê·¸ ê°€ëŠ¥í•œ ì¹´ë“œ
  - Badgeë¡œ íƒ€ì… êµ¬ë¶„ (variant: default/secondary/outline)
  - Badgeë¡œ íŠ¸ë¦¬ê±° íƒœê·¸ (/blog_post)
  - Button (size="icon", variant="ghost")ë¡œ ë¹ ë¥¸ ì¶”ê°€
  - Lucide React ì•„ì´ì½˜ (Plus, GripVertical)
- **ì„±ëŠ¥ ìµœì í™”**: React.memoë¡œ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€

#### Step 2.2: FilterTabs ì»´í¬ë„ŒíŠ¸ (shadcn/ui Tabs ë˜ëŠ” Button)
- **íŒŒì¼**: `src/sidepanel/components/FilterTabs.tsx` (ì‹ ê·œ)
- **shadcn/ui ì»´í¬ë„ŒíŠ¸**: Tabs, TabsList, TabsTrigger ë˜ëŠ” Button (variant="ghost")
- **ì‘ì—…**: [ì „ì²´], [í…œí”Œë¦¿], [ì»¨í…ìŠ¤íŠ¸], [ì˜ˆì‹œ] í•„í„°ë§
- **ê¸°ëŠ¥**:
  - íƒ€ì…ë³„ í•„í„°ë§
  - ì¹´ìš´íŠ¸ í‘œì‹œ Badge
  - í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ (ë°©í–¥í‚¤)

#### Step 2.3: Library ë©”ì¸ ì»´í¬ë„ŒíŠ¸ (shadcn/ui í†µí•©)
- **íŒŒì¼**: `src/sidepanel/components/Library.tsx` (ì‹ ê·œ)
- **shadcn/ui ì»´í¬ë„ŒíŠ¸**: Card, Input (Search), ScrollArea
- **ì‘ì—…**:
  - Input with Search icon (lucide-react)
  - FilterTabs í†µí•©
  - ScrollAreaë¡œ ê°€ìƒ ìŠ¤í¬ë¡¤ë§
  - ìë™ í¬ì»¤ìŠ¤ (useEffect + ref)
- **IndexedDB ìµœì í™”**:
  - ë””ë°”ìš´ìŠ¤ ê²€ìƒ‰ (300ms)
  - íƒ€ì… ì¸ë±ìŠ¤ í™œìš©
  - í˜ì´ì§€ë„¤ì´ì…˜ (50ê°œì”©)

#### Step 2.4: HTML5 Drag & Drop êµ¬í˜„ (External ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´)
- **íŒŒì¼**: `src/hooks/useDragAndDrop.ts` (ì‹ ê·œ)
- **ì‘ì—…**:
  - HTML5 Drag API ì»¤ìŠ¤í…€ í›…
  - TypeScript íƒ€ì… ì•ˆì „ì„±
  - ë“œë˜ê·¸ í”„ë¦¬ë·° ì»¤ìŠ¤í„°ë§ˆì´ì§•
  - ë“œë¡­ ì¡´ ì‹œê°ì  í”¼ë“œë°±
- **ì¥ì **:
  - ì¶”ê°€ ì˜ì¡´ì„± ì—†ìŒ
  - ë²ˆë“¤ í¬ê¸° ìµœì†Œí™”
  - shadcn/uiì™€ ì™„ë²½ í˜¸í™˜

### Phase 3: Builder ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ (5-6ì¼)

#### Step 3.1: ê¸°ë³¸ Builder êµ¬ì¡°
- **íŒŒì¼**: `src/sidepanel/components/Builder.tsx` (ì‹ ê·œ)
- **ì‘ì—…**:
  - ë¹ˆ ìƒíƒœ (EmptyState)
  - ì—˜ë¦¬ë¨¼íŠ¸ ì¶”ê°€ ì‹œ ìŠ¬ë¡¯ ì‹œìŠ¤í…œ í™œì„±í™”
  - ë“œë¡­ ì¡´ ì„¤ì •

#### Step 3.2: SlotComponent êµ¬í˜„
- **íŒŒì¼**: `src/sidepanel/components/SlotComponent.tsx` (ì‹ ê·œ)
- **ì‘ì—…**:
  - ë¹ˆ ìŠ¬ë¡¯ í”Œë ˆì´ìŠ¤í™€ë”
  - ë“œë¡­ ì´ë²¤íŠ¸ ì²˜ë¦¬
  - ì¸ë¼ì¸ ê²€ìƒ‰ (/ ì…ë ¥ ì‹œ)
  - ì œê±° ë²„íŠ¼ (x)

#### Step 3.3: TemplateSlot êµ¬í˜„
- **íŒŒì¼**: `src/sidepanel/components/TemplateSlot.tsx` (ì‹ ê·œ)
- **ì‘ì—…**:
  - í…œí”Œë¦¿ í‘œì‹œ
  - í•˜ìœ„ ìŠ¬ë¡¯ ë™ì  ìƒì„±
  - í…œí”Œë¦¿ ë³€ê²½ ì‹œ ìŠ¬ë¡¯ ë¦¬ì…‹

#### Step 3.4: ActionButtons êµ¬í˜„
- **íŒŒì¼**: `src/sidepanel/components/ActionButtons.tsx` (ì‹ ê·œ)
- **ì‘ì—…**:
  - [â¡ï¸ ì…ë ¥ì°½ì— ì ìš©] ë²„íŠ¼
  - [ğŸ“‹ ë³µì‚¬] ë²„íŠ¼
  - í”„ë¡¬í”„íŠ¸ ì¡°ë¦½ ë¡œì§

### Phase 4: í†µí•© ë° ê³ ê¸‰ ê¸°ëŠ¥ (3-4ì¼)

#### Step 4.1: í”„ë¡¬í”„íŠ¸ ì¡°ë¦½ ì—”ì§„
- **íŒŒì¼**: `src/lib/promptEngine.ts` (ì‹ ê·œ)
- **ì‘ì—…**:
  - í…œí”Œë¦¿ + ìŠ¬ë¡¯ â†’ ìµœì¢… í”„ë¡¬í”„íŠ¸ ë³€í™˜
  - ë³€ìˆ˜ ì¹˜í™˜ ë° í…œí”Œë¦¿ ì²˜ë¦¬
  - ê²€ì¦ ë¡œì§

#### Step 4.2: ì¸ë¼ì¸ ê²€ìƒ‰ êµ¬í˜„
- **íŒŒì¼**: `src/sidepanel/components/InlineSearch.tsx` (ì‹ ê·œ)
- **ì‘ì—…**:
  - ìŠ¬ë¡¯ í´ë¦­ ì‹œ íŒì—… ê²€ìƒ‰
  - íƒ€ì…ë³„ í•„í„°ë§ ìë™ ì ìš©
  - í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜

#### Step 4.3: Content Script í†µí•©
- **íŒŒì¼**: `src/content/ContentManager.ts` ìˆ˜ì •
- **ì‘ì—…**:
  - í”„ë¡¬í”„íŠ¸ ì£¼ì… ê¸°ëŠ¥ ì¶”ê°€
  - í”Œë«í¼ë³„ ì…ë ¥ì°½ ê°ì§€
  - ë©”ì‹œì§€ íŒ¨ì‹±ìœ¼ë¡œ Builderì™€ ì—°ë™

#### Step 4.4: PromptStudio ë©”ì¸ ì»´í¬ë„ŒíŠ¸
- **íŒŒì¼**: `src/sidepanel/PromptStudio.tsx` (ì‹ ê·œ)
- **ì‘ì—…**:
  - Library + Builder í†µí•©
  - ë ˆì´ì•„ì›ƒ ê´€ë¦¬ (ìƒë‹¨/í•˜ë‹¨ ë¶„í• )
  - ì „ì—­ ìƒíƒœ ì—°ê²°

### Phase 5: ê¸°ì¡´ ì½”ë“œì™€ í†µí•© (2-3ì¼)

#### Step 5.1: ë¼ìš°íŒ… ì„¤ì •
- **íŒŒì¼**: `src/sidepanel/App.tsx` ìˆ˜ì •
- **ì‘ì—…**:
  - PromptStudio í˜ì´ì§€ ì¶”ê°€
  - ë„¤ë¹„ê²Œì´ì…˜ íƒ­ ë˜ëŠ” ëª¨ë“œ ì „í™˜
  - ê¸°ì¡´ ê¸°ëŠ¥ê³¼ ê³µì¡´

#### Step 5.2: ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
- **íŒŒì¼**: `src/lib/migration.ts` (ì‹ ê·œ)
- **ì‘ì—…**:
  - ê¸°ì¡´ snippetsë¥¼ elementsë¡œ ë³€í™˜
  - ê¸°ë³¸ í…œí”Œë¦¿ ìƒì„±
  - ë²„ì „ ê´€ë¦¬ ë¡œì§

#### Step 5.3: ìŠ¤íƒ€ì¼ë§ ì¡°ì •
- **íŒŒì¼**: CSS/Tailwind í´ë˜ìŠ¤ ì¡°ì •
- **ì‘ì—…**:
  - ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì‹œê°ì  í”¼ë“œë°±
  - ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ
  - ë‹¤í¬ ëª¨ë“œ ëŒ€ì‘

#### Step 5.4: ìµœì¢… í…ŒìŠ¤íŒ… ë° ë²„ê·¸ ìˆ˜ì •
- **ì‘ì—…**:
  - ì—”ë“œíˆ¬ì—”ë“œ í…ŒìŠ¤íŠ¸
  - ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ í™•ì¸
  - ì„±ëŠ¥ ìµœì í™”

## 5. ê¸°ì¡´ í”„ë¡œì íŠ¸ ë³€ê²½ì‚¬í•­

### 5.1 ì œê±°í•  ê¸°ì¡´ ì½”ë“œ (Legacy Code Cleanup)

#### ì™„ì „ ì œê±° ëŒ€ìƒ
- **src/sidepanel/App.tsx**: ê¸°ì¡´ Snippet ê¸°ë°˜ UI ì „ì²´ ì œê±°
- **src/hooks/useSnippets.ts**: Snippet/Role ì¡°í•© ë¡œì§ ì œê±°
- **ê¸°ì¡´ SnippetCard ì»´í¬ë„ŒíŠ¸**: ëª¨ë“  Snippet ê´€ë ¨ UI ì»´í¬ë„ŒíŠ¸

#### src/types.ts
```diff
- export interface Snippet { ... }  // ì™„ì „ ì œê±°
- export interface Role { ... }     // ì™„ì „ ì œê±°
+ export interface Element {        // ìƒˆë¡œ ì¶”ê°€
+   type: 'template' | 'context' | 'example' | 'role';
+   ...
+ }
```

#### src/lib/db.ts
```diff
- snippets!: EntityTable<Snippet, "id">;  // ì œê±°
- roles!: EntityTable<Role, "id">;        // ì œê±°
+ elements!: EntityTable<Element, "id">;  // ë‹¨ì¼ í…Œì´ë¸”

- // ê¸°ì¡´ ë³µì¡í•œ ë²„ì „ ê´€ë¦¬ ì œê±°
+ // ë‹¨ìˆœí•œ Element ì¤‘ì‹¬ ìŠ¤í‚¤ë§ˆ
+ this.version(1).stores({
+   elements: "id, type, trigger, title, content, createdAt, usageCount, *tags"
+ });
```

#### src/lib/messaging.ts
```diff
- searchSnippets()     // ì œê±°
- getAllRoles()        // ì œê±°
- saveSnippet()        // ì œê±°
+ searchElements()     // ìƒˆë¡œ ì¶”ê°€
+ createElement()      // ìƒˆë¡œ ì¶”ê°€
+ updateElement()      // ìƒˆë¡œ ì¶”ê°€
```

### 5.2 ìƒˆë¡œ ìƒì„±í•  íŒŒì¼ë“¤

#### src/stores/elementStore.ts
- Element ì¤‘ì‹¬ ìƒíƒœ ê´€ë¦¬ (Zustand)

#### src/stores/builderStore.ts
- Builder ì „ìš© ìƒíƒœ ê´€ë¦¬

#### src/lib/promptEngine.ts
- Element ì¡°í•© â†’ ìµœì¢… í”„ë¡¬í”„íŠ¸ ë³€í™˜ ë¡œì§

#### src/hooks/useElements.ts
- Element CRUD ë° ê²€ìƒ‰ í›… (useSnippets ëŒ€ì²´)

#### src/sidepanel/PromptStudio.tsx
- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ (ê¸°ì¡´ App.tsx ì™„ì „ ëŒ€ì²´)

#### src/sidepanel/components/
- **Library.tsx**: Element ê²€ìƒ‰/íƒìƒ‰ ì˜ì—­
- **Builder.tsx**: í”„ë¡¬í”„íŠ¸ ì¡°ë¦½ ì˜ì—­
- **ElementCard.tsx**: 4ê°€ì§€ íƒ€ì… ì§€ì› ì¹´ë“œ
- **FilterTabs.tsx**: [ì „ì²´]/[í…œí”Œë¦¿]/[ì»¨í…ìŠ¤íŠ¸]/[ì˜ˆì‹œ]/[ì—­í• ] íƒ­
- **SlotComponent.tsx**: í…œí”Œë¦¿ ìŠ¬ë¡¯ UI
- **ActionButtons.tsx**: ì£¼ì…/ë³µì‚¬ ë²„íŠ¼
- **InlineSearch.tsx**: ìŠ¬ë¡¯ ë‚´ ê²€ìƒ‰ íŒì—…
- **ElementDialog.tsx**: Element ìƒì„±/í¸ì§‘ ëª¨ë‹¬

#### src/content/ContentManager.ts
```diff
+ // í”„ë¡¬í”„íŠ¸ ì£¼ì… ê¸°ëŠ¥ ì¶”ê°€
+ injectPrompt(prompt: string): void
+ detectInputField(): HTMLElement | null
```

### 5.3 íŒ¨í‚¤ì§€ ì˜ì¡´ì„± ë³€ê²½

#### í˜„ì¬ í”„ë¡œì íŠ¸ (ë³€ê²½ ì—†ìŒ)
```json
{
  "dependencies": {
    "@radix-ui/react-slot": "^1.2.3",  // shadcn/ui ê¸°ë°˜
    "class-variance-authority": "^0.7.1",  // shadcn/ui ìŠ¤íƒ€ì¼ë§
    "clsx": "^2.1.1",
    "dexie": "^4.2.0",  // IndexedDB (ì´ë¯¸ êµ¬ì¶•ë¨)
    "lucide-react": "^0.544.0",  // ì•„ì´ì½˜ (ì´ë¯¸ êµ¬ì¶•ë¨)
    "react": "^19.1.1",
    "react-dom": "^19.1.1",
    "tailwind-merge": "^3.3.1",  // shadcn/ui ìœ í‹¸ë¦¬í‹°
    "uuid": "^13.0.0",
    "zustand": "^5.0.8"
  }
}
```

#### shadcn/ui ì¶”ê°€ ì»´í¬ë„ŒíŠ¸ë§Œ ì„¤ì¹˜
- **ì™¸ë¶€ ë“œë˜ê·¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆí•„ìš”**: HTML5 Drag API ì‚¬ìš©
- **ê¸°ì¡´ êµ¬ì¡° í™œìš©**: Dexie (IndexedDB), Zustand (ìƒíƒœê´€ë¦¬)
- **ì¶”ê°€ ì„¤ì¹˜**: `npx shadcn@latest add [component]` ë°©ì‹

## 6. ê°œë°œ ìš°ì„ ìˆœìœ„ ë° ìœ„í—˜ìš”ì†Œ

### 6.1 í•µì‹¬ ê¸°ëŠ¥ ìš°ì„ ìˆœìœ„
1. **High**: ê¸°ë³¸ ë“œë˜ê·¸ ì•¤ ë“œë¡­, í…œí”Œë¦¿ ìŠ¬ë¡¯ ì‹œìŠ¤í…œ
2. **Medium**: ì¸ë¼ì¸ ê²€ìƒ‰, í”„ë¡¬í”„íŠ¸ ì£¼ì…
3. **Low**: ê³ ê¸‰ í•„í„°ë§, í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤

### 6.2 ê¸°ìˆ ì  ìœ„í—˜ìš”ì†Œ (IndexedDB & shadcn/ui ê³ ë ¤)
- **IndexedDB ì„±ëŠ¥**: ëŒ€ìš©ëŸ‰ Element ê²€ìƒ‰ ì‹œ ì„±ëŠ¥ ì €í•˜
- **HTML5 Drag API**: ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ í„°ì¹˜ ì§€ì› ì œí•œ
- **shadcn/ui ì»¤ìŠ¤í„°ë§ˆì´ì§•**: ê¸°ë³¸ ìŠ¤íƒ€ì¼ê³¼ ë§ì§€ ì•ŠëŠ” ë””ìì¸ ìš”êµ¬
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ë³µí•© ì¸ë±ìŠ¤ì™€ ìºì‹œë¡œ ì¸í•œ ë©”ëª¨ë¦¬ ì¦ê°€

### 6.3 ì™„í™” ë°©ì•ˆ (ìµœì í™” ì „ëµ)
- **IndexedDB ìµœì í™”**:
  - ë³µí•© ì¸ë±ìŠ¤ í™œìš©: [type, createdAt]
  - í˜ì´ì§€ë„¤ì´ì…˜: 50ê°œì”© ë¡œë“œ
  - ë””ë°”ìš´ìŠ¤ ê²€ìƒ‰: 300ms
  - ìì£¼ ì‚¬ìš©í•˜ëŠ” í…œí”Œë¦¿ ë©”ëª¨ë¦¬ ìºì‹œ
- **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**:
  - React DevTools Profiler
  - Chrome DevTools IndexedDB íƒ­
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¶”ì 
- **ëŒ€ì•ˆ ì¤€ë¹„**:
  - í„°ì¹˜ ë””ë°”ì´ìŠ¤ìš© ëŒ€ì²´ UI (Button ê¸°ë°˜)
  - shadcn/ui CSS ë³€ìˆ˜ ì»¤ìŠ¤í„°ë§ˆì´ì§•
  - ì ì§„ì  ê¸°ëŠ¥ ì¶”ê°€ (Progressive Enhancement)

## 7. ì„±ê³µ ì§€í‘œ

### 7.1 ê¸°ëŠ¥ì  ì§€í‘œ (IndexedDB & shadcn/ui)
- **IndexedDB ì„±ëŠ¥**: ê²€ìƒ‰ ì‘ë‹µ ì‹œê°„ <200ms (50ê°œ Element ê¸°ì¤€)
- **UI ë°˜ì‘ì„±**: shadcn/ui ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ <50ms
- **ë“œë˜ê·¸ ì•¤ ë“œë¡­**: HTML5 API ì™„ë£Œìœ¨ 95%+ (ë°ìŠ¤í¬í†±)
- **í”„ë¡¬í”„íŠ¸ ì¡°ë¦½**: í…œí”Œë¦¿ + ìŠ¬ë¡¯ ì„±ê³µë¥  98%+
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: 100ê°œ Element ë¡œë“œ ì‹œ <10MB ë©”ëª¨ë¦¬ ì‚¬ìš©

### 7.2 ì‚¬ìš©ì ê²½í—˜ ì§€í‘œ
- **í•™ìŠµ ê³¡ì„ **: ì²« ì‚¬ìš© í›„ 3ë¶„ ë‚´ ê¸°ë³¸ ì¡°ë¦½ ì™„ë£Œ (shadcn/ui ì¼ê´€ì„±)
- **ì›Œí¬í”Œë¡œìš° íš¨ìœ¨ì„±**: ê¸°ì¡´ ëŒ€ë¹„ 60% ì‹œê°„ ë‹¨ì¶•
- **ì ‘ê·¼ì„±**: shadcn/ui ê¸°ë³¸ ì ‘ê·¼ì„± ì¤€ìˆ˜ (í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜)
- **ì˜¤ë¥˜ìœ¨**: ì‚¬ìš©ì ì˜¤ë¥˜ <3% (ì§ê´€ì  UI)

### 7.3 ê¸°ìˆ ì  ì§€í‘œ
- **Bundle Size**: ì¶”ê°€ ì½”ë“œ <100KB (HTML5 Drag, shadcn/uië§Œ ì‚¬ìš©)
- **IndexedDB íš¨ìœ¨**: ë³µí•© ì¸ë±ìŠ¤ë¡œ ê²€ìƒ‰ ì„±ëŠ¥ 5ë°° í–¥ìƒ
- **Code Quality**: TypeScript 100% íƒ€ì… ì•ˆì „ì„±
- **Performance**: Lighthouse ì„±ëŠ¥ ì ìˆ˜ 90+ ìœ ì§€

---

**ì´ ì˜ˆìƒ ê°œë°œ ê¸°ê°„**: 12-16ì¼ (ëŒ€í­ ë‹¨ì¶•)
**ë‹¨ì¶• ì´ìœ **:
- **Element ë‹¨ì¼ ëª¨ë¸**: Snippet/Role ë³µì¡ì„± ì œê±°ë¡œ 4-5ì¼ ë‹¨ì¶•
- **ê¸°ì¡´ ì¸í”„ë¼ í™œìš©**: shadcn/ui, IndexedDB(Dexie), Zustand ê·¸ëŒ€ë¡œ ì‚¬ìš©
- **Legacy ì½”ë“œ ì •ë¦¬**: ê¹”ë”í•œ ì‹œì‘ìœ¼ë¡œ ë²„ê·¸ ìœ„í—˜ ê°ì†Œ
- **ë‹¨ìˆœí•œ ë°ì´í„° íë¦„**: í•˜ë‚˜ì˜ í…Œì´ë¸”, í•˜ë‚˜ì˜ ê²€ìƒ‰ ë¡œì§

**ê¶Œì¥ ê°œë°œ ìˆœì„œ**:
1. **Phase 1**: Legacy ì œê±° + Element ëª¨ë¸ êµ¬ì¶• (2-3ì¼)
2. **Phase 2**: Library ì»´í¬ë„ŒíŠ¸ (shadcn/ui ê¸°ë°˜, 3-4ì¼)
3. **Phase 3**: Builder ì»´í¬ë„ŒíŠ¸ (3-4ì¼)
4. **Phase 4**: í†µí•© ë° í”„ë¡¬í”„íŠ¸ ì£¼ì… (2-3ì¼)
5. **Phase 5**: í…ŒìŠ¤íŒ… ë° ìµœì í™” (2ì¼)

**í•µì‹¬ ì„±ê³µ ìš”ì¸**:
- **Clean Start**: Legacy ì½”ë“œ ì™„ì „ ì œê±°ë¡œ ê¹”ë”í•œ ì‹œì‘
- **Element ì¤‘ì‹¬ ì„¤ê³„**: 4ê°€ì§€ íƒ€ì…ìœ¼ë¡œ ëª¨ë“  ê¸°ëŠ¥ í†µí•©
- **shadcn/ui ì¼ê´€ì„±**: ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ íŒ¨í„´ ì¤€ìˆ˜
- **IndexedDB ìµœì í™”**: ë‹¨ì¼ í…Œì´ë¸”ë¡œ ë‹¨ìˆœí•˜ê³  ë¹ ë¥¸ ê²€ìƒ‰

**ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ**:
- ê¸°ì¡´ ì‚¬ìš©ì ë°ì´í„° ì†ì‹¤ ì—†ì´ Elementë¡œ ìë™ ë³€í™˜
- ì ì§„ì  ê¸°ëŠ¥ í™œì„±í™”ë¡œ ì•ˆì •ì„± í™•ë³´